# AdConnector
Основной класс, устанавливающий соединение с MS AD. Так же используется для выполнения запросов (получения объектов) к MS AD. При подключении проверятся, что контроллер, к которому произошло подключение - RW. В противном случае происходит поиск RW-контроллеров и переподключение.

## New (domainName, userName, userPwd)
* **domainName**: Строка. Имя домена для подключения. Можно указать конкретный контроллер домена для подключения. Если передано пустое значение, будет выброшена ошибка AD_ERR_PARAMEMPTY (3500)
* **userName**: Строка. Логин учетной записи, под которой необходимо выполнить подключение. Логин следует вводить с указанием домена. Если передать пустое значение (""), подключение будет произведено с использованием текущей учетной записи.
* **userPwd**: Строка. Пароль для учетной записи, под которой необходимо выполнить подключение, если параметр userName не пуст. Игнорируется, если параметр userName пуст. 

## DomainControllerName: String GET
Возвращает текущее имя контроллера домена, к которому было выполнено подключение.

## DomainName: String GET
Возвращает текущее имя домена.

## ConvertToADAttribute (srcString): String
Конвертирует переданное значение, удаляя спец. символы (, " « ») и обрезая значение до 64 символов.
* **srcString**: Строка - значение, которое необходимо конвертировать.

## CreateADObject (objType, fullName, objContainer): ADObject
Создает новый объект в MS AD заданного типа. Внимание! Метод не сохраняет объект, для сохранения объекта, необходимо вызвать метод Save() в экземпляре класса ADObject.
* **objType**: Строка - тип создаваемого объекта (см Константы. Типы объектов). Тип AD_OBJECT_COMPUTER  (устройство) на текущий момент не поддерживается. При передаче этого значения возникнет ошибка.
* **fullName**: Строка - имя объекта
* **objContainer**: Строка - контейнер, содержащий новый объект. Если в качестве значения будут передан Nothing, будет выброшена ошибка AD_ERROR_PARAMNOTHING (3501)

## Delete ()
Деструктор. Освобождение ресурсов.

## FindObj (topObj, objType, objName, searchAttr): ADObject
Производит поиск объекта в MS AD в заданными параметрами. Возвращает только один (первый) объект, удовлетворяющий критериям поиска. Если объект не найден, вернет Nothing.
* **topObj**: ADOU - объект-контейнер, в поддереве которого следует производить поиск. Если значение параметра Nothing - поиск будет происходит от корня.
* **objType**: Строка - тип искомого объекта (см Константы. Типы объектов)	
* **objName**: Строка - ключ поиска
* **searchAtrr**: Строка - атрибут объекта, по которому производится поиск. Значение можно задать через уже определенные константы библиотеки (см Константы. Предопределенные атрибуты объектов) или вручную, задав любой атрибут.

## GetADObject (objType, adObj): ADObject
Преобразовывает (оборачивает) OLE-объект в экземпляр класса ADObject.
* **objType**: Строка - тип объекта (см Константы. Типы объектов)
* **adObj**: Variant - OLE-объект

## InitObj (objPath): Variant
Получает OLE-объект MS AD по его полному пути. Если получить объект не удалось, будет выброшена ошибка AD_ERR_ADOBJECTNOTFOUND (3504)
* **objPath**: Строка - путь к объекту в каноническом виде (CN=...)